---
title: "Tidy Tuesday Week 21"
author: "@jasonmstevens"
date: "8/20/2018"
output:
  html_document:
    theme: journal
    toc: yes
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## How A Booming Population And Climate Change Made Californiaâ€™s Wildfires Worse Than Ever

This is my take on the 2018 August 21 dataset provided by rfordatascience/tidytuesday.

<br>

The data for this study can be found here:

<p>

<https://github.com/rfordatascience/tidytuesday/tree/master/data/week21>

<br>

All the following code for this exercise can be found at my github repo here:

<p>

<https://github.com/jasonmstevensphd/tidytuesday/tree/2018_08_21>

<br>

Lastly, the corresponding article from Buzzfeed can be found here:

<p>

<https://www.buzzfeednews.com/article/peteraldhous/california-wildfires-people-climate>

<br>

Here we go!

###Initial Exploration of the Dataset

```{r Libraries, message=FALSE, warning=FALSE, EVAL=FALSE, include=FALSE}

# This is where we import our libraries and files. We'll also add some information to be included on our plots

library(knitr)
library(tidyverse)
library(RColorBrewer)
library(lubridate)

Cal_Fires <- read_csv("week21_calfire_frap.csv") %>%
  mutate(Alarm_Date = ymd(alarm_date)) %>%
  mutate(Contained_Date = ymd(cont_date)) %>%
  mutate(Year = year(Alarm_Date)) %>%
  rename(Fire_Name = fire_name) %>%
  mutate(cause2 = case_when(cause == 1 | cause == 17 ~ "Natural",
                            cause == 14 | is.na(cause) ~ "Unknown",
                            cause != 1 | cause != 14 | cause != 17 ~ "Human"))

Time_of_Analysis <- now(tz = "America/New_York")
Analyst <- "@jasonmstevens"

plot <-        theme(plot.background = element_rect(fill = "white"))+
               theme(panel.background = element_rect(fill = "white",
                                                     colour="grey50"))+
               theme(plot.title = element_text(face = "bold", 
                                  size = 18,
                                  color = "navy"))+
               theme(axis.title = element_text(face = "bold", size = 16))+
               theme(aspect.ratio = 3.5/5)

```

<br>

To start, I imported the calfires_week21_frap.csv and I employed the case_when function that the original auther used to assign cause_2 as it's not explicitly clear what the numbers correlate to in the dataset. This was a nice example of "case_when" that I'll definitely add to my repretoire. 

```{r Barplot of California Wildfires, echo=FALSE, message=FALSE, warning=FALSE, tidy=TRUE}

Cal_Fires_Bar <- Cal_Fires %>%
  group_by(Year) %>%
  summarize(Burned_Acres = sum(gis_acres), na.rm = TRUE) %>%
  ggplot(aes(Year, Burned_Acres))+
  geom_smooth()+
  geom_bar(stat = "identity")+
  ggtitle("Acres Burned for California Wildfires")+
  labs(x = "Year", y = "Acres Burned",
       subtitle = paste("Generated by", Analyst, "on", Time_of_Analysis))+
  plot

Cal_Fires_Bar

```

Text

```{r California Wildfires by Month, echo=FALSE, message=FALSE, warning=FALSE, tidy=TRUE}

Cal_Fires_Month <- Cal_Fires %>%
  mutate(Month = month(Alarm_Date, label = TRUE)) %>%
  group_by(Month) %>%
  summarize(Burned_Acres = sum(gis_acres), na.rm = TRUE) %>%
  ggplot(aes(Month, Burned_Acres))+
  geom_smooth()+
  geom_bar(stat = "identity")+
  ggtitle("Acres Burned for California Wildfires\nby Month Since 1950")+
  labs(x = "Month", y = "Acres Burned",
       subtitle = paste("Generated by", Analyst, "on", Time_of_Analysis))+
  plot

Cal_Fires_Month
  

```

```{r Active Season California Wildfires, echo=FALSE, message=FALSE, warning=FALSE, tidy=TRUE}

Active_Season <- c("Aug", "Sep", "Oct")

Cal_Fires_Active <- Cal_Fires %>%
  mutate(Month = month(Alarm_Date, label = TRUE)) %>%
  filter(Month %in% Active_Season) %>%
  group_by(Year) %>%
  summarize(Burned_Acres = sum(gis_acres), na.rm = TRUE) %>%
  ggplot(aes(Year, Burned_Acres))+
  geom_smooth()+
  geom_bar(stat = "identity")+
  ggtitle("Acres Burned for California Wildfires\n During Active Season by Year")+
  labs(x = "Year", y = "Acres Burned",
       subtitle = paste("Generated by", Analyst, "on", Time_of_Analysis))+
  plot

Cal_Fires_Active
  
```

```{r Quiet Season California Wildfires, echo=FALSE, message=FALSE, warning=FALSE, tidy=TRUE}

Active_Season <- c("Aug", "Sep", "Oct")

Cal_Fires_Quiet <- Cal_Fires %>%
  mutate(Month = month(Alarm_Date, label = TRUE)) %>%
  filter(!(Month %in% Active_Season)) %>%
  group_by(Year) %>%
  summarize(Burned_Acres = sum(gis_acres), na.rm = TRUE) %>%
  ggplot(aes(Year, Burned_Acres))+
  geom_smooth()+
  geom_bar(stat = "identity")+
  ggtitle("Acres Burned for California Wildfires\n During Quiet Season by Year")+
  labs(x = "Year", y = "Acres Burned",
       subtitle = paste("Generated by", Analyst, "on", Time_of_Analysis))+
  plot

Cal_Fires_Quiet

ggsave(Cal_Fires_Quiet, filename = "Cal_Fire_Quiet.png")
  
```